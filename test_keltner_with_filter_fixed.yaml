# Test Keltner strategy with filter using volume_sma_20
description: Test Keltner strategy with volume filter
mode: optimization

topology: backtest

# Do NOT manually define features - they should be discovered from filter
# feature_configs:
#   volume_sma_20:
#     type: volume_sma
#     period: 20

classifiers:
  - market_regime_classifier:
      params:
        atr_period: 14
        rsi_period: 14
        sma_short: 50
        sma_long: 200

symbols:
  - SPY

strategy:
  - keltner_bands:
      period: [30]
      multiplier: [1.5]
      filter: "signal == 0 or volume > volume_sma_20 * 1.2"

risk_config:
  max_position_size: 0.1
  risk_per_trade: 0.02
  max_portfolio_heat: 0.06
  stop_loss_pct: 0.02
  trailing_stop_pct: 0.03

data_config:
  timeframe: 5m
  start_date: 2024-01-01
  end_date: 2024-11-01
  train_split: 0.8

tracing_config:
  level: minimal
EOF < /dev/null